<div class="animated fadeIn">
    <div class="card" id="new">
        <div class="card-header"><i class="icon-wrench"></i> Pengaturan SPPD</div>
            <div class="card-block">
                <div class="row">
                    <div class="col-md-12">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#home3" role="tab" aria-controls="home"><i class="icon-paper-clip"></i> Tanda Tangan</a>
                                </li>
                                <li class="nav-item">
                                    <a id="biaya2Tab" class="nav-link tabAjax" data-toggle="tab" href="#biaya2Tabchild" role="tab" aria-controls="biaya2Tabchild"><i class="icon-wallet"></i> Biaya-Biaya</a>
                                </li>
                                <li class="nav-item">
                                    <a id="tiketPesawatTab" class="nav-link tabAjax" data-toggle="tab" href="#tiketPesawatTabchild" role="tab" aria-controls="tiketPesawatTabchild"><i class="icon-plane"></i> Biaya Tiket</a>
                                </li>
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane active" id="home3" role="tabpanel">
                                    <div class="col-md-5">   
                                        <div class="form-group row">
                                        <h6><i class="icon-user-follow"></i> Penanda Tangan Surat Tugas</h6> 
                                            <div class="input-group">
                                                <input id="inp-ttd-surat-tugas" name="nama" class="form-control pegawai-autocomplete" placeholder="Ketikkan nama" required>
                                                <span class="input-group-btn">
                                                    <button id="btn-ttd-surat-tugas" class="btn btn-primary">+</button>
                                                </span>
                                            </div>                                    
                                        </div>
                                    </div>                           
                                    <table id="tbl-ttd-st" class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Nama</th>
                                                <th>NIP</th>
                                                <th>Pilihan</th>
                                            </tr>
                                        </thead>
                                        <tbody>                                            
                                        {{#each setting.ttd_st}}
                                            <tr>
                                                <td>{{nama}}</td>
                                                <td>{{_id}}</td>
                                                <td>
                                                    <button type="button" class="btn-st-default" {{#if_eq _id ../setting.ttd_st_default}}disabled="disabled"{{/if_eq}}><i class="icon-pin"></i></button>
                                                    <button type="button" class="btn-st-del"><i class="icon-close"></i></button>
                                                </td>
                                            </tr>
                                        {{/each}}  
                                        </tbody>
                                    </table>  

                                    <div class="col-md-5">   
                                        <div class="form-group row">
                                            <h6><i class="icon-user-follow"></i> Penanda Tangan Legalitas</h6>
                                            <div class="input-group">
                                                <input id="inp-ttd-legalitas" name="nama" class="form-control pegawai-autocomplete" placeholder="Ketikkan nama" required>
                                                <span class="input-group-btn">
                                                    <button id="btn-ttd-legalitas" type="submit" class="btn btn-primary">+</button>
                                                </span>
                                            </div> 
                                        </div>
                                    </div>
                                            <table id="tbl-ttd-leg" class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Nama</th>
                                                        <th>NIP</th>
                                                        <th>Pilihan</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                {{#each setting.ttd_leg}}
                                                    <tr>
                                                        <td>{{nama}}</td>
                                                        <td>{{_id}}</td>
                                                        <td>
                                                            <button type="button" class="btn-leg-default" {{#if_eq _id ../setting.ttd_leg_default}}disabled="disabled"{{/if_eq}}><i class="icon-pin"></i></button>
                                                            <button type="button" class="btn-leg-del"><i class="icon-close"></i></button>
                                                        </td>
                                                    </tr>
                                                {{/each}}                                            
                                                </tbody>
                                            </table>
                                    <div class="col-md-5">   
                                        <div class="form-group row">
                                            <h6><i class="icon-user"></i> Pejabat Pembuat Komitmen</h6>
                                            <div class="input-group">
                                                <input type="text" id="inp-ppk" name="nama" class="form-control pegawai-autocomplete" placeholder="Ketikkan nama" value="{{#with setting.ppk}}{{nama}}{{/with}}" required>
                                                <span class="input-group-btn">
                                                    <button id="btn-set-ppk" type="submit" class="btn btn-primary">Set</button>
                                                </span>
                                            </div> 
                                        </div>
                                    </div> 
                                    <div class="col-md-5">   
                                        <div class="form-group row">
                                            <h6><i class="icon-user"></i> Bendahara Pengeluaran STIS</h6>
                                            <div class="input-group">
                                                <input type="text" id="inp-bend" name="nama" class="form-control pegawai-autocomplete" placeholder="Ketikkan nama" value="{{#with setting.bendahara}}{{nama}}{{/with}}" required>
                                                <span class="input-group-btn">
                                                    <button id="btn-set-bend" type="submit" class="btn btn-primary">Set</button>
                                                </span>
                                            </div> 
                                        </div>
                                    </div> 
                                </div>
                                <div class="tab-pane" id="biaya2Tabchild" role="tabpanel">
                                    <table id="tbl-biaya-biaya" class="table table-bordered" width="100%">
                                        <thead>
                                            <tr>
                                                <th rowspan="2">Id</th>
                                                <th width="5%" rowspan="2" class="text-center" style="vertical-align: middle">No.</th>
                                                <th width="20%" rowspan="2" class="text-center" style="vertical-align: middle">Provinsi</th>
                                                <th width="10%" rowspan="2" class="text-center" style="vertical-align: middle">Taksi</th>
                                                <th width="25%" colspan="3" scope="colgroup" class="text-center">Uang Harian</th>
                                                <th width="35%" colspan="5" scope="colgroup" class="text-center">Tarif Hotel</th>
                                            </tr>
                                            <tr>
                                                <th class="text-center">Luar kota</th>
                                                <th class="text-center">Dalam kota > 8 jam</th>
                                                <th class="text-center" style="vertical-align: middle">Diklat</th>
                                                <th class="text-center" style="vertical-align: middle">Eselon I</th>
                                                <th class="text-center" style="vertical-align: middle">Eselon II</th>
                                                <th class="text-center">Eselon III/Gol. IV</th>
                                                <th class="text-center">Eselon IV/Gol. III</th>
                                                <th class="text-center" style="vertical-align: middle">Gol. I/II</th>
                                            </tr>
                                        </thead>
                                        <tbody>                                           
                                        </tbody>
                                    </table>
                                </div>
                                <div class="tab-pane" id="tiketPesawatTabchild" role="tabpanel">
                                    <table id="tiket" class="table table-bordered" width="100%">
                                        <thead>
                                            <tr>
                                                <th rowspan="2">Id</th>
                                                <th width="2%" rowspan="2" class="text-center" style="vertical-align: middle">No.</th>
                                                <th width="40%" rowspan="2" class="text-center" style="vertical-align: middle">Kota</th>
                                                <th width="55%" colspan="2" class="text-center">Pesawat (dari Jakarta)</th>
                                            </tr>
                                            <tr>
                                                <th class="text-center">Bisnis</th>
                                                <th class="text-center">Ekonomi</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        {{#each kota}}             
                                            <tr name="{{name}}">
                                                <td>{{label}}</td>
                                                <td jenis="tiket_jkt_b" class="money">{{tiket_jkt_b}}</td>
                                                <td jenis="tiket_jkt_e" class="money">{{tiket_jkt_e}}</td>
                                            </tr>
                                        {{/each}}                                            
                                        </tbody>
                                    </table>
                                </div>
                            </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    socket = io.connect($(location).attr('host'));
    loadCSS("/css/typeahead.css");

    $(document).ready(function(){
        //init state id peg umum
        var selected_peg_id = '';
        //register auto complete
        $('.pegawai-autocomplete').typeahead({
                hint: true,
                highlight: true,
                minLength: 1
            }, {
                source: function(q, p){
                        {
                            socket.emit('penerima_list', {'query': q, 'type': 'pegawai_only'}, function (data) {
                                return p(_.map(data, function(peg){ return {_id: peg._id, value: peg.nama}}))
                            });
                        }
                }
            }
        );

        //update id peg
        $(".pegawai-autocomplete").on("typeahead:selected typeahead:autocompleted", function(e, datum) {
            selected_peg_id = datum._id;
        });

        $('#btn-ttd-surat-tugas').click(function(){
            socket.emit('add_ttd_st', {_id: selected_peg_id}, 
                function(status){
                    if(status == 'sukses'){
                        generalAlert('Berhasil ditambahkan.');
                        $('#tbl-ttd-st tbody').append(
                                '<tr>'
                                +'<td>'+$('#inp-ttd-surat-tugas').val()+'</td>'
                                +'<td>'+selected_peg_id+'</td>'
                                +'<td><button type="button" class="btn-st-default">'
                                +'<i class="icon-pin"></i></button> '
                                +'<button type="button" class="btn-st-del"><i class="icon-close"></i></button></td>'
                                +'</tr>'
                            );
                        $('#inp-ttd-surat-tugas').val('');
                    } else {
                        generalAlert('Gagal ditambahkan. Hubungi Admin.');
                    }
            })
        })

        $('#btn-ttd-legalitas').click(function(){
            socket.emit('add_ttd_leg', {_id: selected_peg_id}, 
                function(status){
                    if(status == 'sukses'){
                        generalAlert('Berhasil ditambahkan.');
                        $('#tbl-ttd-leg tbody').append(
                                '<tr>'
                                +'<td>'+$('#inp-ttd-legalitas').val()+'</td>'
                                +'<td>'+selected_peg_id+'</td>'
                                +'<td><button type="button" class="btn-leg-default">'
                                +'<i class="icon-pin"></i></button> '
                                +'<button type="button" class="btn-leg-del"><i class="icon-close"></i></button></td>'
                                +'</tr>'
                            );
                        $('#inp-ttd-legalitas').val('');
                    } else {
                        generalAlert('Gagal ditambahkan. Hubungi Admin.');
                    }
            })
        })

        $('#btn-set-ppk').click(function(){
            socket.emit('set_ppk', {nama: $('#inp-ppk').val(), _id: selected_peg_id}, 
                function(status){
                    if(status == 'sukses'){
                        generalAlert('Berhasil diubah.');
                        
                    } else {
                        generalAlert('Gagal diubah. Hubungi Admin.');
                    }
            })
        })

        $('#btn-set-bend').click(function(){
            socket.emit('set_bend', {nama: $('#inp-bend').val(), _id: selected_peg_id}, 
                function(status){
                    if(status == 'sukses'){
                        generalAlert('Berhasil diubah.');
                        
                    } else {
                        generalAlert('Gagal diubah. Hubungi Admin.');
                    }
            })
        })

        //tombol ttd st
        $('#tbl-ttd-st').on('click', '.btn-st-default', function(){
            var element = $(this);
            var prev = element.closest('tr').siblings().find("[disabled='disabled']");
            socket.emit('set_default_ttd_st', {_id: $(this).closest('tr').find('td:eq(1)').text()}, 
                function(status){
                    if(status == 'sukses'){
                        element.attr('disabled', 'disabled');
                        prev.removeAttr('disabled');
                        generalAlert('Berhasil diubah.');
                        
                    } else {
                        generalAlert('Gagal diubah. Hubungi Admin.');
                    }
            })
        })
        $('#tbl-ttd-st').on('click', '.btn-st-del', function(){
            var element = $(this).closest('tr');
            socket.emit('ttd_st_remove', $(this).closest('tr').find('td:eq(1)').text(), 
                function(status){
                    if(status == 'sukses'){
                        element.remove();
                        generalAlert('Berhasil diubah.');
                    } else {
                        generalAlert('Gagal diubah. Hubungi Admin.');
                    }
            })
        })

        //tombol ttd leg
        $('#tbl-ttd-leg').on('click', '.btn-leg-default', function(){
            var element = $(this);
            var prev = element.closest('tr').siblings().find("[disabled='disabled']");
            socket.emit('set_default_ttd_leg', {_id: $(this).closest('tr').find('td:eq(1)').text()}, 
                function(status){
                    if(status == 'sukses'){
                        element.attr('disabled', 'disabled');
                        prev.removeAttr('disabled');
                        generalAlert('Berhasil diubah.');
                        
                    } else {
                        generalAlert('Gagal diubah. Hubungi Admin.');
                    }
            })
        })
        $('#tbl-ttd-leg').on('click', '.btn-leg-del', function(){
            var element = $(this).closest('tr');
            socket.emit('ttd_leg_remove', $(this).closest('tr').find('td:eq(1)').text(), 
                function(status){
                    if(status == 'sukses'){
                        element.remove();
                        generalAlert('Berhasil dihapus.');
                    } else {
                        generalAlert('Gagal dihapus. Hubungi Admin.');
                    }
            })
        })

        //############ biaya-biaya


        $('#tbl-biaya-biaya').DataTable({
            columnDefs: [
                {
                    "targets": [ 0 ],
                    "visible": false,
                    "searchable": false
                }
            ],
            aaSorting: [],
            rowReorder: {
                enable: false
            },
            paging: false,
            createdRow: function( row, data, dataIndex ) {
                $( row ).find('td:eq(0)').attr('class', 'text-center');
                $( row ).find('td:eq(2)').attr('class','format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(3)').attr('class','format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(4)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(5)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(6)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(7)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(8)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(9)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(10)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(11)').attr('class', 'format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
            }
        });

        $("#biaya2Tab").click(function(){
            socket.emit('biaya2_list', '', 
                function(response){
                    $('#tbl-biaya-biaya').DataTable().clear();
                    _.each(response, function(prov, i, list){
                        var row = [
                            prov._id,
                            i+1,
                            prov.nama,
                            prov.taksi_dn || 0,
                            prov.har_dn_lk || 0,
                            prov.har_dn_dk || 0,
                            prov.har_dn_dik || 0,
                            prov.inap_dn_es1 || 0,
                            prov.inap_dn_es2 || 0,
                            prov.inap_dn_es3_g4 || 0,
                            prov.inap_dn_es4_g3 || 0,
                            prov.inap_dn_g12 || 0
                        ]
                        $('#tbl-biaya-biaya').DataTable().row.add( row );
                    });
                    $('#tbl-biaya-biaya').DataTable().draw(false);
            })
        })

        //Inline editor tabel biaya2
        var state_active_editor_entry = false;
        var editor_entry;
        var active_entry;
        $("#tbl-biaya-biaya").on('dblclick', 'tr td', function () {
            active_entry = $(this);
            if(state_active_editor_entry || active_entry.is(':nth-child(1)')){
                $.toast({
                    text: 'Anda tidak dapat mengedit sel tersebut.',
                    textAlign: 'left', 
                    hideAfter: 1000,
                    loader: false,
                    position: 'bottom-right',
                    allowToastClose: false
                })
                return;
            }
            state_active_editor_entry = true;
            var cloneProperties = ['padding', 'padding-top', 'padding-bottom', 'padding-left', 'padding-right',
                          'text-align', 'font', 'font-size', 'font-family', 'font-weight',
                          'border', 'border-top', 'border-bottom', 'border-left', 'border-right'];

            if(active_entry.hasClass('format-uang')){
                editor_entry = $('<input type="text" class="format-uang">').val(getNumber(active_entry.text())).hide().appendTo(active_entry.parent());
            } else {
                editor_entry = $('<textarea></textarea>').val(active_entry.text()).hide().appendTo(active_entry.parent());
            }

            editor_entry.css('position', 'absolute');
            editor_entry
                .show()
                .offset(active_entry.offset())
                .css(active_entry.css(cloneProperties))
                .width(active_entry.width())
                .height(active_entry.height())
                .focus();
            editor_entry.select();
        });

        $("#tbl-biaya-biaya").on('blur keydown', 'input,textarea', function (e) {
            //jika enter anggap blur (krn klo tidak, di fired 2 kali)
            if (e.which === 13){
                $(this).blur();
            } else if (e.which === 0){//jika blur ==> keycode nya 0
                if(editor_entry.val() !== active_entry.text()){
                    if(editor_entry.val() == ''){
                        editor_entry.val(0);
                    }
                    var row = $("#tbl-biaya-biaya").DataTable().row(active_entry.closest('tr'));
                    var data = {};

                    if(active_entry.is(':nth-child(2)')){
                        data.nama = editor_entry.val();
                    } else if(active_entry.is(':nth-child(3)')){
                        data.taksi_dn = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(4)')){
                        data.har_dn_lk = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(5)')){
                        data.har_dn_dk = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(6)')){
                        data.har_dn_dik = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(7)')){
                        data.inap_dn_es1 = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(8)')){
                        data.inap_dn_es2 = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(9)')){
                        data.inap_dn_es3_g4 = getNumber(editor_entry.val());
                    } else if(active_entry.is(':nth-child(10)')){
                        data.inap_dn_es4_g3 = getNumber(editor_entry.val());
                    } else {
                        data.inap_dn_g12 = getNumber(editor_entry.val());
                    }

                    socket.emit('prov_biaya2_edit', {'_id': row.data()[0], 'data': data}, function(status){
                            if(status === 'sukses'){
                                $("#tbl-biaya-biaya").DataTable()
                                    .cell(active_entry)
                                    .data(editor_entry.val())
                                    .draw(false);
                                generalAlert('Berhasil diedit.');
                                active_entry = null;
                                state_active_editor_entry = false;
                                editor_entry.hide(); 
                            } else {
                                generalAlert('Gagal diedit. Hubungi admin.');
                            }
                    });                     
                } else {
                    active_entry = null;
                    state_active_editor_entry = false;
                    editor_entry.hide();  
                }
            } else if(e.which === 27){
                active_entry = null;
                state_active_editor_entry = false;
                editor_entry.hide();
            }
        });

        //############ tiket
        $('#tiket').DataTable({
            columnDefs: [
                {
                    "targets": [ 0 ],
                    "visible": false,
                    "searchable": false
                }
            ],
            aaSorting: [],
            rowReorder: {
                enable: false
            },
            pageLength: 50,
            createdRow: function( row, data, dataIndex ) {
                $( row ).find('td:eq(0)').attr('class', 'text-center');
                $( row ).find('td:eq(2)').attr('class','format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
                $( row ).find('td:eq(3)').attr('class','format-uang').autoNumeric('init', {digitGroupSeparator: ',', decimalCharacter: '.', decimalPlacesOverride: '0'});
            }
        });

        $("#tiketPesawatTab").click(function(){
            socket.emit('tiket_list', '', 
                function(response){
                    $('#tiket').DataTable().clear();
                    _.each(response, function(kab, i, list){
                        var row = [
                            kab._id,
                            i+1,
                            kab.nama,
                            kab.tiket_jkt_b || 0,
                            kab.tiket_jkt_e || 0
                        ]
                        $('#tiket').DataTable().row.add( row );
                    });
                    $('#tiket').DataTable().draw(false);
            })
        })

        var Tiket = {};

        //Inline editor tabel biaya2
        Tiket.state_active_editor_entry = false;
        Tiket.editor_entry;
        Tiket.active_entry;
        $("#tiket").on('dblclick', 'tr td', function () {
            Tiket.active_entry = $(this);
            if(Tiket.state_active_editor_entry || Tiket.active_entry.is(':nth-child(1)')){
                $.toast({
                    text: 'Anda tidak dapat mengedit sel tersebut.',
                    textAlign: 'left', 
                    hideAfter: 1000,
                    loader: false,
                    position: 'bottom-right',
                    allowToastClose: false
                })
                return;
            }
            Tiket.state_active_editor_entry = true;
            var cloneProperties = ['padding', 'padding-top', 'padding-bottom', 'padding-left', 'padding-right',
                          'text-align', 'font', 'font-size', 'font-family', 'font-weight',
                          'border', 'border-top', 'border-bottom', 'border-left', 'border-right'];

            if(Tiket.active_entry.hasClass('format-uang')){
                Tiket.editor_entry = $('<input type="text" class="format-uang">').val(getNumber(Tiket.active_entry.text())).hide().appendTo(Tiket.active_entry.parent());
            } else {
                Tiket.editor_entry = $('<textarea></textarea>').val(Tiket.active_entry.text()).hide().appendTo(Tiket.active_entry.parent());
            }

            Tiket.editor_entry.css('position', 'absolute');
            Tiket.editor_entry
                .show()
                .offset(Tiket.active_entry.offset())
                .css(Tiket.active_entry.css(cloneProperties))
                .width(Tiket.active_entry.width())
                .height(Tiket.active_entry.height())
                .focus();
            Tiket.editor_entry.select();
        });

        $("#tiket").on('blur keydown', 'input,textarea', function (e) {
            //jika enter anggap blur (krn klo tidak, di fired 2 kali)
            if (e.which === 13){
                $(this).blur();
            } else if (e.which === 0){//jika blur ==> keycode nya 0
                if(Tiket.editor_entry.val() !== Tiket.active_entry.text()){
                    if(Tiket.editor_entry.val() == ''){
                        Tiket.editor_entry.val(0);
                    }
                    var row = $("#tiket").DataTable().row(Tiket.active_entry.closest('tr'));
                    var data = {};

                    if(Tiket.active_entry.is(':nth-child(2)')){
                        data.nama = Tiket.editor_entry.val();
                    } else if(Tiket.active_entry.is(':nth-child(3)')){
                        data.tiket_jkt_b = getNumber(Tiket.editor_entry.val());
                    } else{
                        data.tiket_jkt_e = getNumber(Tiket.editor_entry.val());
                    }

                    socket.emit('kab_tiket_edit', {'_id': row.data()[0], 'data': data}, function(status){
                            if(status === 'sukses'){
                                $("#tiket").DataTable()
                                    .cell(Tiket.active_entry)
                                    .data(Tiket.editor_entry.val())
                                    .draw(false);
                                generalAlert('Berhasil diedit.');
                                Tiket.active_entry = null;
                                Tiket.state_active_editor_entry = false;
                                Tiket.editor_entry.hide(); 
                            } else {
                                generalAlert('Gagal diedit. Hubungi admin.');
                            }
                    });                     
                } else {
                    Tiket.active_entry = null;
                    Tiket.state_active_editor_entry = false;
                    Tiket.editor_entry.hide();  
                }
            } else if(e.which === 27){
                Tiket.active_entry = null;
                Tiket.state_active_editor_entry = false;
                Tiket.editor_entry.hide();
            }
        });


        function getNumber(obj){
            if(!obj || obj == '-' || obj == '') return 0;
            if (typeof obj === 'string' || obj instanceof String) return +obj.replace(/\D/g, '');
            return +obj;
        }

        function getNumber(obj){
            if(!obj || obj == '-' || obj == '') return 0;
            if (typeof obj === 'string' || obj instanceof String) return +obj.replace(/\D/g, '');
            return +obj;
        }

        function generalAlert(message){
            $.toast({
                text: message,
                textAlign: 'left', 
                hideAfter: 4000,
                loader: false,
                position: 'bottom-right'
            })
        }
    })
</script>